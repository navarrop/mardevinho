---
import { getCollection, getEntry, render } from 'astro:content';
import BlogPost from '../../themes/classic/BlogPost.astro';

export const prerender = true;

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { slug } = Astro.params;
const post = await getEntry('posts', slug);

if (!post) {
  return Astro.redirect('/404');
}

const { Content } = await render(post);

const author = post.data.author ? await getEntry('authors', post.data.author) : null;
---

<BlogPost 
    post={post}
    author={author}
    Content={Content}
    themeId="classic"
/>
