---
/**
 * admin/pages/index.astro
 * 
 * P√°gina de listagem de p√°ginas (singletons) no painel administrativo.
 * Agora mostra apenas as p√°ginas do tema ativo.
 */

import { getEntry } from 'astro:content';
import AdminLayout from '../../../layouts/AdminLayout.astro';

// Obter tema ativo
const settings = await getEntry('siteSettings', 'settings');
const activeThemeId = settings?.data?.activeTheme || 'classic';
const theme = await getEntry('siteThemes', activeThemeId);
const themeName = theme?.data?.name || activeThemeId;

// Verificar se o tema foi alterado
const themeChanged = Astro.url.searchParams.get('themeChanged') === 'true';
const successMessage = Astro.url.searchParams.get('success');
---

<AdminLayout title="Configura√ß√µes - CNX Agency Admin">
    <div class="space-y-6">
        <!-- Theme Changed Notification -->
        {themeChanged && (
            <div class="admin-card p-4 bg-blue-500/10 border border-blue-500/30">
                <div class="flex items-center gap-3">
                    <span class="text-2xl">üîÑ</span>
                    <div class="flex-1">
                        <p class="text-blue-400 font-semibold mb-1">Tema alterado com sucesso!</p>
                        {successMessage && (
                            <p class="text-blue-300 text-sm">{decodeURIComponent(successMessage)}</p>
                        )}
                        <p class="text-blue-200 text-xs mt-2">
                            As configura√ß√µes abaixo agora mostram as p√°ginas do tema <strong>{themeName}</strong>. 
                            Clique em qualquer p√°gina para editar.
                        </p>
                    </div>
                </div>
            </div>
        )}

        <!-- Header -->
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-heading font-bold text-[#e5e5e5] mb-2">
                    Configura√ß√µes
                </h1>
                <p class="text-[#a3a3a3]">
                    Gerencie o conte√∫do das p√°ginas do seu site
                </p>
            </div>
            <a 
                href="/" 
                target="_blank"
                class="admin-btn admin-btn-secondary text-sm"
            >
                üëÅÔ∏è Ver Site
            </a>
        </div>

        <!-- Pages Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- Home -->
            <a 
                href="/admin/pages/home"
                class="admin-card p-6 hover:border-primary/50 transition-all group"
            >
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-2xl">
                        üè†
                    </div>
                    <div>
                        <h3 class="text-lg font-heading font-bold text-[#e5e5e5] group-hover:text-white transition-colors">
                            Home
                        </h3>
                        <p class="text-xs text-[#a3a3a3]">P√°gina inicial</p>
                    </div>
                </div>
                <p class="text-sm text-[#a3a3a3]">
                    Edite o conte√∫do da p√°gina inicial, hero, features e CTA
                </p>
            </a>

            <!-- Sobre -->
            <a 
                href="/admin/pages/about"
                class="admin-card p-6 hover:border-primary/50 transition-all group"
            >
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-2xl">
                        üìÑ
                    </div>
                    <div>
                        <h3 class="text-lg font-heading font-bold text-[#e5e5e5] group-hover:text-white transition-colors">
                            Sobre
                        </h3>
                        <p class="text-xs text-[#a3a3a3]">Sobre N√≥s</p>
                    </div>
                </div>
                <p class="text-sm text-[#a3a3a3]">
                    Miss√£o, vis√£o, valores e equipe
                </p>
            </a>

            <!-- Contato -->
            <a 
                href="/admin/pages/contact"
                class="admin-card p-6 hover:border-primary/50 transition-all group"
            >
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-2xl">
                        üìß
                    </div>
                    <div>
                        <h3 class="text-lg font-heading font-bold text-[#e5e5e5] group-hover:text-white transition-colors">
                            Contato
                        </h3>
                        <p class="text-xs text-[#a3a3a3]">P√°gina de contato</p>
                    </div>
                </div>
                <p class="text-sm text-[#a3a3a3]">
                    Informa√ß√µes de contato e formul√°rio
                </p>
            </a>

            <!-- Menu -->
            <a 
                href="/admin/pages/menu"
                class="admin-card p-6 hover:border-primary/50 transition-all group"
            >
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-2xl">
                        ‚ò∞
                    </div>
                    <div>
                        <h3 class="text-lg font-heading font-bold text-[#e5e5e5] group-hover:text-white transition-colors">
                            Menu & Logo
                        </h3>
                        <p class="text-xs text-[#a3a3a3]">Navega√ß√£o e identidade visual</p>
                    </div>
                </div>
                <p class="text-sm text-[#a3a3a3]">
                    Logo (texto ou imagem) e itens do menu de navega√ß√£o
                </p>
            </a>

            <!-- Rodap√© -->
            <a 
                href="/admin/pages/footer"
                class="admin-card p-6 hover:border-primary/50 transition-all group"
            >
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-2xl">
                        üìã
                    </div>
                    <div>
                        <h3 class="text-lg font-heading font-bold text-[#e5e5e5] group-hover:text-white transition-colors">
                            Rodap√©
                        </h3>
                        <p class="text-xs text-[#a3a3a3]">Rodap√© do site</p>
                    </div>
                </div>
                <p class="text-sm text-[#a3a3a3]">
                    Copyright, links e redes sociais
                </p>
            </a>

            <!-- Landing Page 1 -->
            <a 
                href="/admin/pages/lp1"
                class="admin-card p-6 hover:border-primary/50 transition-all group"
            >
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-lg bg-[#1a1a1a] flex items-center justify-center text-2xl">
                        üöÄ
                    </div>
                    <div>
                        <h3 class="text-lg font-heading font-bold text-[#e5e5e5] group-hover:text-white transition-colors">
                            Landing Page 1
                        </h3>
                        <p class="text-xs text-[#a3a3a3]">LP1 - Dot Com Secrets</p>
                    </div>
                </div>
                <p class="text-sm text-[#a3a3a3]">
                    Edite todo o conte√∫do da landing page
                </p>
            </a>
        </div>
    </div>
</AdminLayout>
