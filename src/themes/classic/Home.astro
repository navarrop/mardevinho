---
/**
 * Home.astro - P√°gina Inicial Institucional
 * 
 * P√°gina inicial completa com estrutura institucional:
 * - Header (j√° inclu√≠do no MainLayout)
 * - Hero Section
 * - Prova Social (logos de clientes)
 * - √öltimas Postagens (grid 3x3)
 * - Quem Somos (2 colunas)
 * - O Que Entregamos (9 servi√ßos, 3 por linha)
 * - Contato
 * - Rodap√© (j√° inclu√≠do no MainLayout)
 */

import MainLayout from '../../layouts/MainLayout.astro';
import { readSingleton } from '../../utils/singleton-utils';

interface Props {
    homeData: any;
    themeId: string;
    latestPosts: any[];
}

const { homeData, themeId, latestPosts } = Astro.props;

// Buscar dados de contato do singleton do tema ativo
const contactData = await readSingleton('contact', themeId);
---

<MainLayout title={homeData.heroTitle || 'CNX Agency - Desenvolvimento Web Moderno'}>
    
    <!-- HERO SECTION -->
    <section class="relative min-h-screen flex items-center justify-center pt-24 md:pt-32 overflow-hidden">
        <div class="absolute inset-0" style="background: var(--blog-hero-grad);">
            <div class="absolute inset-0 opacity-30">
                <div class="absolute inset-0" style="background-image: linear-gradient(to right, var(--blog-grid) 1px, transparent 1px), linear-gradient(to bottom, var(--blog-grid) 1px, transparent 1px); background-size: 60px 60px;"></div>
            </div>
            <div class="absolute top-1/4 left-1/4 w-[500px] h-[500px] bg-primary/5 rounded-full blur-[120px] animate-pulse"></div>
            <div class="absolute bottom-1/3 right-1/4 w-[400px] h-[400px] bg-secondary/8 rounded-full blur-[100px] animate-pulse" style="animation-delay: 1.5s;"></div>
        </div>
        
        <div class="container mx-auto px-6 relative z-10">
            <div class="max-w-5xl mx-auto text-center">
                {homeData.heroBadge && (
                    <div class="inline-flex items-center gap-2 px-5 py-2.5 mb-10 rounded-full border border-primary/40 bg-primary/10 backdrop-blur-sm">
                        <span class="text-sm md:text-base font-semibold text-primary tracking-wide">{homeData.heroBadge}</span>
                    </div>
                )}
                
                <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-heading font-black leading-[1.1] mb-8" style="color: var(--blog-text);">
                    {homeData.heroTitle || 'Transformando Ideias em Resultados Digitais'}
                </h1>
                
                {homeData.heroSubtitle && (
                    <p class="text-lg md:text-xl lg:text-2xl max-w-3xl mx-auto mb-12 leading-relaxed" style="color: var(--blog-text-muted);">
                        {homeData.heroSubtitle}
                    </p>
                )}
                
                {homeData.heroCtaText && (
                    <div class="flex flex-col items-center gap-4">
                        <a href={homeData.heroCtaUrl || '/contato'} class="inline-flex items-center justify-center gap-2 px-8 md:px-12 py-4 md:py-6 bg-primary text-white font-bold uppercase tracking-wider rounded-xl hover:scale-105 active:scale-95 transition-all shadow-[0_0_40px_rgba(168,85,247,0.4)] hover:shadow-[0_0_60px_rgba(168,85,247,0.6)]">
                            <span>{homeData.heroCtaText}</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                                <path d="M5 12h14"></path>
                                <path d="m12 5 7 7-7 7"></path>
                            </svg>
                        </a>
                    </div>
                )}
            </div>
        </div>
        
        <div class="absolute bottom-0 left-0 right-0 h-40" style="background: var(--blog-fade-bottom);"></div>
    </section>

    <!-- PROVA SOCIAL -->
    {homeData.clientLogos && homeData.clientLogos.length > 0 && (
        <section class="py-16 md:py-24 relative overflow-hidden" style="background: var(--blog-section-dark);">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-2xl md:text-3xl font-heading font-bold mb-4" style="color: var(--blog-text);">
                        {homeData.socialProofTitle || 'Clientes que Confiam em N√≥s'}
                    </h2>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-8 items-center justify-items-center max-w-6xl mx-auto">
                    {homeData.clientLogos.map((client: any) => (
                        <a 
                            href={client.url || '#'} 
                            target={client.url ? '_blank' : '_self'}
                            rel={client.url ? 'noopener noreferrer' : ''}
                            class="opacity-60 hover:opacity-100 transition-opacity grayscale hover:grayscale-0"
                        >
                            {client.logo ? (
                                <img 
                                    src={client.logo} 
                                    alt={client.name || 'Cliente'} 
                                    class="max-h-16 w-auto mx-auto"
                                    loading="lazy"
                                />
                            ) : (
                                <div class="text-center">
                                    <p class="text-sm font-semibold" style="color: var(--blog-text-muted);">{client.name}</p>
                                </div>
                            )}
                        </a>
                    ))}
                </div>
            </div>
        </section>
    )}

    <!-- √öLTIMAS POSTAGENS -->
    {latestPosts && latestPosts.length > 0 && (
        <section class="py-20 md:py-32 relative overflow-hidden" style="background: var(--blog-section-alt);">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading font-black mb-4" style="color: var(--blog-text);">
                        √öltimas <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Postagens</span>
                    </h2>
                    <p class="text-lg max-w-2xl mx-auto" style="color: var(--blog-text-muted);">
                        Confira nossos artigos mais recentes sobre desenvolvimento web, SEO e tecnologia
                    </p>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 lg:gap-8 max-w-7xl mx-auto">
                    {latestPosts.map((post) => {
                        const thumbnail = post.data.thumbnail || post.data.metaImage;
                        return (
                        <a 
                            href={`/blog/${post.id}`} 
                            class="blog-card group block p-6"
                        >
                            {thumbnail ? (
                                <div class="mb-4 rounded-xl overflow-hidden aspect-video" style="background: var(--blog-surface);">
                                    <img 
                                        src={thumbnail} 
                                        alt={post.data.title}
                                        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                                        loading="lazy"
                                    />
                                </div>
                            ) : (
                                <div class="mb-4 rounded-xl overflow-hidden aspect-video bg-gradient-to-br from-primary/20 to-secondary/20 flex items-center justify-center" style="border: 1px solid var(--blog-border);">
                                    <span class="text-4xl opacity-50">üìù</span>
                                </div>
                            )}
                            <div class="mb-3">
                                {post.data.category && (
                                    <span class="text-[10px] font-bold uppercase tracking-widest px-3 py-1 bg-primary/20 text-primary border border-primary/30 rounded-full">
                                        {post.data.category}
                                    </span>
                                )}
                            </div>
                            <h3 class="text-xl font-bold mb-3 group-hover:text-primary transition-colors leading-tight line-clamp-2" style="color: var(--blog-text);">
                                {post.data.title}
                            </h3>
                            {post.data.metaDescription && (
                                <p class="text-sm mb-4 line-clamp-2" style="color: var(--blog-text-muted);">
                                    {post.data.metaDescription}
                                </p>
                            )}
                            <div class="flex items-center justify-between text-sm" style="color: var(--blog-text-subtle);">
                                {post.data.publishedDate && (
                                    <span>
                                        {new Date(post.data.publishedDate).toLocaleDateString('pt-BR', {
                                            day: '2-digit',
                                            month: 'short',
                                            year: 'numeric'
                                        })}
                                    </span>
                                )}
                                <span class="group-hover:translate-x-2 transition-transform duration-300 text-primary">
                                    Ler mais ‚Üí
                                </span>
                            </div>
                        </a>
                        );
                    })}
                </div>
                
                {latestPosts.length >= 9 && (
                    <div class="text-center mt-12">
                        <a 
                            href="/blog" 
                            class="inline-flex items-center gap-2 px-8 py-4 rounded-lg font-semibold backdrop-blur-sm transition-all hover:border-primary/50"
                            style="background: var(--blog-surface); color: var(--blog-text); border: 1px solid var(--blog-border);"
                        >
                            Ver Todos os Posts
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M5 12h14"></path>
                                <path d="m12 5 7 7-7 7"></path>
                            </svg>
                        </a>
                    </div>
                )}
            </div>
        </section>
    )}

    <!-- QUEM SOMOS -->
    {homeData.aboutTitle && (
        <section class="py-20 md:py-32 relative overflow-hidden" style="background: var(--blog-section-dark);">
            <div class="container mx-auto px-6">
                <div class="grid lg:grid-cols-2 gap-12 lg:gap-16 items-center max-w-6xl mx-auto">
                    <div class="space-y-6">
                        <div>
                            <span class="text-primary font-semibold uppercase tracking-wider text-sm">Sobre N√≥s</span>
                            <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading font-black mt-4 mb-6 leading-tight" style="color: var(--blog-text);">
                                {homeData.aboutTitle}
                            </h2>
                            {homeData.aboutSubtitle && (
                                <p class="text-lg mb-6" style="color: var(--blog-text-muted);">
                                    {homeData.aboutSubtitle}
                                </p>
                            )}
                        </div>
                        
                        {homeData.aboutContent && (
                            <p class="text-lg leading-relaxed" style="color: var(--blog-text-muted);">
                                {homeData.aboutContent}
                            </p>
                        )}
                        
                        {homeData.aboutStats && homeData.aboutStats.length > 0 && (
                            <div class="grid grid-cols-3 gap-6 pt-8">
                                {homeData.aboutStats.map((stat: any) => (
                                    <div class="text-center">
                                        <p class="text-3xl md:text-4xl font-black text-primary mb-2">
                                            {stat.number}
                                        </p>
                                        <p class="text-sm" style="color: var(--blog-text-muted);">
                                            {stat.label}
                                        </p>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                    
                    <div class="relative">
                        {homeData.aboutImage ? (
                            <div class="rounded-2xl overflow-hidden aspect-square" style="background: var(--blog-surface); border: 1px solid var(--blog-border);">
                                <img 
                                    src={homeData.aboutImage} 
                                    alt={homeData.aboutTitle || 'Sobre N√≥s'}
                                    class="w-full h-full object-cover"
                                    loading="lazy"
                                />
                            </div>
                        ) : (
                            <div class="rounded-2xl aspect-square bg-gradient-to-br from-primary/20 to-secondary/20 border border-primary/30 flex items-center justify-center">
                                <span class="text-6xl">üë®‚Äçüíª</span>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        </section>
    )}

    <!-- O QUE ENTREGAMOS (SERVI√áOS) -->
    {homeData.services && homeData.services.length > 0 && (
        <section class="py-20 md:py-32 relative overflow-hidden" style="background: var(--blog-section-alt);">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-primary/3 rounded-full blur-[150px] pointer-events-none"></div>
            
            <div class="container mx-auto px-6 relative z-10">
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading font-black mb-4" style="color: var(--blog-text);">
                        {homeData.servicesTitle || 'O Que Entregamos'}
                    </h2>
                    {homeData.servicesSubtitle && (
                        <p class="text-lg max-w-2xl mx-auto" style="color: var(--blog-text-muted);">
                            {homeData.servicesSubtitle}
                        </p>
                    )}
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 lg:gap-8 max-w-7xl mx-auto">
                    {homeData.services.slice(0, 9).map((service: any) => (
                        <a 
                            href={service.url || '#'}
                            class="blog-card group relative p-8 h-full hover:shadow-[0_0_40px_rgba(168,85,247,0.2)]"
                        >
                            <div class="w-14 h-14 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center mb-6 transition-all duration-300 group-hover:bg-primary/20 group-hover:border-primary/40">
                                <span class="text-3xl">{service.icon || '‚ö°'}</span>
                            </div>
                            <h3 class="text-xl font-bold mb-4 group-hover:text-primary transition-colors" style="color: var(--blog-text);">
                                {service.title}
                            </h3>
                            <p class="leading-relaxed" style="color: var(--blog-text-muted);">
                                {service.description}
                            </p>
                            <div class="absolute inset-0 rounded-2xl bg-gradient-to-b from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
                        </a>
                    ))}
                </div>
            </div>
        </section>
    )}

    <!-- CONTATO -->
    {contactData && (
        <section class="py-20 md:py-32 relative overflow-hidden" style="background: var(--blog-section-dark);">
            <div class="container mx-auto px-6">
                <div class="max-w-4xl mx-auto text-center">
                    <h2 class="text-3xl md:text-4xl lg:text-5xl font-heading font-black mb-6" style="color: var(--blog-text);">
                        Entre em <span class="bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Contato</span>
                    </h2>
                    {contactData.heroSubtitle && (
                        <p class="text-lg mb-12 max-w-2xl mx-auto" style="color: var(--blog-text-muted);">
                            {contactData.heroSubtitle}
                        </p>
                    )}
                    
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <a 
                            href="/contato" 
                            class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-primary text-white font-bold rounded-xl hover:scale-105 transition-all shadow-xl"
                        >
                            Fale Conosco
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M5 12h14"></path>
                                <path d="m12 5 7 7-7 7"></path>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    )}

</MainLayout>

<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
