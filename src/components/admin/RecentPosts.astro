---
/**
 * RecentPosts.astro
 * 
 * Widget que exibe os posts mais recentes do blog.
 * Permite acesso rÃ¡pido Ã  ediÃ§Ã£o e visualizaÃ§Ã£o de conteÃºdo.
 * Design limpo com lista de cards clicÃ¡veis.
 * 
 * Props:
 * - posts: Array de posts do Astro Content Collection
 */

interface Props {
    posts: any[];
}

const { posts } = Astro.props;

// Ordenar por data de publicaÃ§Ã£o (mais recentes primeiro)
const sortedPosts = [...posts]
    .sort((a, b) => {
        const dateA = a.data.publishedDate ? new Date(a.data.publishedDate).getTime() : 0;
        const dateB = b.data.publishedDate ? new Date(b.data.publishedDate).getTime() : 0;
        return dateB - dateA;
    })
    .slice(0, 5); // Apenas os 5 mais recentes

function formatDate(dateString: string | undefined) {
    if (!dateString) return 'Sem data';
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString('pt-BR', { 
            day: '2-digit', 
            month: 'short',
            year: 'numeric'
        });
    } catch {
        return 'Data invÃ¡lida';
    }
}
---

<div class="admin-card p-6">
    <div class="flex items-center justify-between mb-6">
        <h2 class="text-lg font-heading font-bold text-[#e5e5e5] flex items-center gap-2">
            <span>ğŸ“</span>
            Posts Recentes
        </h2>
        <a 
            href="/admin/posts" 
            class="text-sm text-[#a3a3a3] hover:text-[#e5e5e5] transition-colors font-medium"
        >
            Ver todos â†’
        </a>
    </div>

    {sortedPosts.length > 0 ? (
        <div class="space-y-2">
            {sortedPosts.map((post) => (
                <a 
                    href={`/admin/posts/${post.data.slug}`}
                    class="block p-4 rounded-lg bg-[#0a0a0a] border border-[rgba(255,255,255,0.08)] hover:border-[rgba(255,255,255,0.12)] hover:bg-[#111111] transition-all group"
                >
                    <div class="flex items-start justify-between gap-4">
                        <div class="flex-1 min-w-0">
                            <h3 class="text-[#e5e5e5] font-medium mb-1 group-hover:text-[#e5e5e5] transition-colors line-clamp-2">
                                {post.data.title}
                            </h3>
                            <div class="flex items-center gap-3 text-xs text-[#737373]">
                                <span>{formatDate(post.data.publishedDate)}</span>
                                {post.data.category && (
                                    <>
                                        <span>â€¢</span>
                                        <span class="px-2 py-0.5 rounded bg-[#1a1a1a] text-[#a3a3a3]">
                                            {post.data.category}
                                        </span>
                                    </>
                                )}
                            </div>
                        </div>
                        <span class="text-[#737373] group-hover:text-[#a3a3a3] transition-colors">â†’</span>
                    </div>
                </a>
            ))}
        </div>
    ) : (
        <div class="text-center py-8 text-[#a3a3a3]">
            <p class="mb-2">Nenhum post encontrado</p>
            <a 
                href="/admin/posts/new" 
                class="text-[#e5e5e5] hover:text-[#e5e5e5] transition-colors font-medium text-sm"
            >
                Criar primeiro post â†’
            </a>
        </div>
    )}
</div>
